# –î–µ–ø–ª–æ–π –∏ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ ‚Äî Planeta –°–¢–û CRM

## üéØ –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

**Planeta** ‚Äî CRM —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞ (–°–¢–û) —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏
- –ó–∞–∫–∞–∑-–Ω–∞—Ä—è–¥—ã —Å –≤–æ—Ä–æ–Ω–∫–æ–π —Å—Ç–∞—Ç—É—Å–æ–≤
- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å–µ—Ä–≤–∏—Å
- –ß–∞—Ç —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏
- –ö–∞—Å—Å–∞ –∏ –æ—Ç—á—ë—Ç—ã

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
npm install
```

### –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```bash
npm run dev
```
–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5173

### –°–±–æ—Ä–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
```bash
npm run build
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ sto/              # –°–¢–û-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ STOMetrics.tsx      # –ú–µ—Ç—Ä–∏–∫–∏ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RecentWorkOrders.tsx # –¢–∞–±–ª–∏—Ü–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–∫–∞–∑–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ TodaySchedule.tsx    # –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
‚îÇ   ‚îú‚îÄ‚îÄ chats/            # –°–∏—Å—Ç–µ–º–∞ —á–∞—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ChatBox.tsx         # –û–∫–Ω–æ —á–∞—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ChatList.tsx        # –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ChatSidebar.tsx     # –°–∞–π–¥–±–∞—Ä —á–∞—Ç–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ ui/               # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (Badge, Modal, Table...)
‚îú‚îÄ‚îÄ context/
‚îÇ   ‚îî‚îÄ‚îÄ STOContext.tsx    # üî• –ì–õ–ê–í–ù–´–ô STATE MANAGEMENT
‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îî‚îÄ‚îÄ sto.ts            # TypeScript —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ initialData.ts    # –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–µ–≤—å—é
‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îú‚îÄ‚îÄ Dashboard/        # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îú‚îÄ‚îÄ Clients.tsx       # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Employees.tsx     # –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ WorkOrders.tsx    # –ó–∞–∫–∞–∑-–Ω–∞—Ä—è–¥—ã
‚îÇ   ‚îú‚îÄ‚îÄ Calendar.tsx      # –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–ø–∏—Å–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ Chat/Chats.tsx    # –ß–∞—Ç
‚îî‚îÄ‚îÄ layout/
    ‚îî‚îÄ‚îÄ AppSidebar.tsx    # –ù–∞–≤–∏–≥–∞—Ü–∏—è
```

---

## üóÑÔ∏è –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (src/types/sto.ts)

### Client (–ö–ª–∏–µ–Ω—Ç)
```typescript
interface Client {
  id: string;
  name: string;           // –§–ò–û
  phone: string;          // –¢–µ–ª–µ—Ñ–æ–Ω (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  email?: string;         // Email (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  createdAt: string;      // –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
  vehicles: string[];     // IDs –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
}
```

### Vehicle (–ê–≤—Ç–æ–º–æ–±–∏–ª—å)
```typescript
interface Vehicle {
  id: string;
  clientId: string;       // –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –∫–ª–∏–µ–Ω—Ç—É
  brand: string;          // –ú–∞—Ä–∫–∞
  model: string;          // –ú–æ–¥–µ–ª—å
  year: number;           // –ì–æ–¥ –≤—ã–ø—É—Å–∫–∞
  gosNumber: string;      // –ì–æ—Å. –Ω–æ–º–µ—Ä
  vin?: string;           // VIN –∫–æ–¥
  mileage?: number;       // –ü—Ä–æ–±–µ–≥
}
```

### Employee (–°–æ—Ç—Ä—É–¥–Ω–∏–∫)
```typescript
interface Employee {
  id: string;
  name: string;
  role: 'mechanic' | 'diagnostician' | 'electrician' | 'manager' | 'admin';
  phone?: string;
  avatar: string;
  isActive: boolean;      // –î–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –∑–∞–∫–∞–∑—ã
}
```

### WorkOrder (–ó–∞–∫–∞–∑-–Ω–∞—Ä—è–¥)
```typescript
interface WorkOrder {
  id: string;
  orderNumber: string;    // –§–æ—Ä–º–∞—Ç: –ó–ù-–ì–ì–ú–ú0001
  clientId: string;
  vehicleId: string;
  employeeId?: string;    // –ù–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –º–∞—Å—Ç–µ—Ä
  title: string;          // –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç
  description?: string;
  status: 'initial_contact' | 'diagnostics' | 'estimate' | 
          'passed_to_work' | 'in_progress' | 'completed';
  priority: 'low' | 'medium' | 'high' | 'urgent';
  services: Service[];    // –°–ø–∏—Å–æ–∫ —Ä–∞–±–æ—Ç/–∑–∞–ø—á–∞—Å—Ç–µ–π
  totalPrice: number;     // –ê–≤—Ç–æ—Å—É–º–º–∞
  createdAt: string;
  updatedAt: string;
  completedAt?: string;
  scheduledDate?: string; // –î–∞—Ç–∞ –∑–∞–ø–∏—Å–∏
}
```

### –í–æ—Ä–æ–Ω–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–∞:
1. `initial_contact` ‚Äî –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç
2. `diagnostics` ‚Äî –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
3. `estimate` ‚Äî –û—Ü–µ–Ω–∫–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
4. `passed_to_work` ‚Äî –ü–µ—Ä–µ–¥–∞–Ω–æ –≤ —Ä–∞–±–æ—Ç—É
5. `in_progress` ‚Äî –í–∑—è—Ç–æ –≤ —Ä–∞–±–æ—Ç—É
6. `completed` ‚Äî –ì–æ—Ç–æ–≤–æ

---

## üîå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Backend (API_SPEC.md)

–§—Ä–æ–Ω—Ç–µ–Ω–¥ –≥–æ—Ç–æ–≤ –∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é REST API. –°–º–æ—Ç—Ä–∏—Ç–µ **API_SPEC.md** –¥–ª—è –ø–æ–ª–Ω–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏.

### –ß—Ç–æ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–∞ Ruby:

1. **REST API** –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π (CRUD)
2. **WebSocket** (ActionCable) –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
3. **Telegram Bot** –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ API –∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É:

–ó–∞–º–µ–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `STOContext` –Ω–∞ API –≤—ã–∑–æ–≤—ã:

```typescript
// –í–º–µ—Å—Ç–æ:
const { clients, addClient } = useClients();

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
const [clients, setClients] = useState([]);
useEffect(() => {
  fetch('/api/v1/clients').then(r => r.json()).then(setClients);
}, []);

const addClient = async (data) => {
  const res = await fetch('/api/v1/clients', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ client: data })
  });
  return res.json();
};
```

---

## üì± Telegram Bot Integration

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- –ö–ª–∏–µ–Ω—Ç—ã –ø–∏—à—É—Ç –±–æ—Ç—É ‚Üí —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ CRM —á–∞—Ç–µ
- –û—Ç–≤–µ—Ç—ã –∏–∑ CRM ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Telegram –∫–ª–∏–µ–Ω—Ç—É
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ –∑–∞–∫–∞–∑–∞ ‚Üí –≤ Telegram

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
1. –°–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook –Ω–∞ `/api/v1/telegram/webhook`
3. –ü—Ä–∏ –ø—Ä–∏–≤—è–∑–∫–µ –∫–ª–∏–µ–Ω—Ç–∞ ‚Äî —Å–æ—Ö—Ä–∞–Ω—è—Ç—å `telegram_chat_id`
4. –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî –≤—ã–∑—ã–≤–∞—Ç—å Telegram Bot API

---

## üåê –î–µ–ø–ª–æ–π –Ω–∞ Beget

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π (SSH)

#### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞
–û—Ç–∫—Ä–æ–π—Ç–µ `deploy.sh` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ:
```bash
BEGET_USER="your_username"   # –í–∞—à –ª–æ–≥–∏–Ω Beget
REMOTE_PATH="~/public_html"  # –ü—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å–∞–π—Ç–∞
```

#### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –Ω–∞ Beget
1. –ó–∞–π–¥–∏—Ç–µ –≤ [–ø–∞–Ω–µ–ª—å Beget](https://cp.beget.com/)
2. –†–∞–∑–¥–µ–ª **SSH-–¥–æ—Å—Ç—É–ø** ‚Üí –í–∫–ª—é—á–∏—Ç—å SSH
3. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ SSH –∫–ª—é—á:
   ```bash
   ssh-keygen -t rsa -b 4096
   cat ~/.ssh/id_rsa.pub
   ```
4. –î–æ–±–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ –ø–∞–Ω–µ–ª–∏ Beget

#### 3. –î–µ–ø–ª–æ–π
```bash
chmod +x deploy.sh
./deploy.sh
```

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π (FTP)

1. –°–±–æ—Ä–∫–∞: `npm run build`
2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å: `cp public/.htaccess dist/.htaccess`
3. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `dist/` –≤ `public_html`

---

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### 404 –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `.htaccess` –∑–∞–≥—Ä—É–∂–µ–Ω —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ RewriteRule.

### –ë–µ–ª—ã–π —ç–∫—Ä–∞–Ω
1. DevTools (F12) ‚Üí Console
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
3. `base` –≤ `vite.config.ts` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `'/'`

### CORS –æ—à–∏–±–∫–∏ (–ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ API)
–ù–∞—Å—Ç—Ä–æ–π—Ç–µ CORS –Ω–∞ –±—ç–∫–µ–Ω–¥–µ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ `.htaccess`:
```apache
<IfModule mod_headers.c>
  Header set Access-Control-Allow-Origin "*"
</IfModule>
```

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω

### –§—Ä–æ–Ω—Ç–µ–Ω–¥:
- [x] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ö–ª–∏–µ–Ω—Ç–æ–≤ —Å CRUD
- [x] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å CRUD  
- [x] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ó–∞–∫–∞–∑-–Ω–∞—Ä—è–¥–æ–≤ —Å CRUD
- [x] –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–ø–∏—Å–µ–π
- [x] –ß–∞—Ç (–ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
- [x] –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
- [x] –ù–∞–≤–∏–≥–∞—Ü–∏—è

### –ë—ç–∫–µ–Ω–¥ (Ruby on Rails):
- [ ] REST API –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π
- [ ] JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- [ ] WebSocket –¥–ª—è real-time
- [ ] Telegram Bot –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- [ ] –î–æ–º–µ–Ω
- [ ] –•–æ—Å—Ç–∏–Ω–≥ –¥–ª—è Rails (Heroku/VPS/etc)
- [ ] Redis –¥–ª—è WebSocket

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

–í–æ–ø—Ä–æ—Å—ã –ø–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É ‚Äî —Å–º–æ—Ç—Ä–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ –∏ —ç—Ç–æ—Ç README.
–í–æ–ø—Ä–æ—Å—ã –ø–æ API ‚Äî —Å–º–æ—Ç—Ä–∏—Ç–µ **API_SPEC.md**.
